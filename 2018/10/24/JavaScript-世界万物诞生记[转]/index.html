<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="橘窝" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><title>JavaScript 世界万物诞生记[转] - 橘窝</title><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">橘窝</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archives</a></li><li class="head-nav__item"><a href="/about" class="head-nav__link">About</a></li><li class="head-nav__item"><a href="/zawen" class="head-nav__link">杂文</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2018-10-24T15:18:30.000Z" class="post__time">October 24, 2018</time><h1 class="post__title"><a href="/2018/10/24/JavaScript-世界万物诞生记[转]/">JavaScript 世界万物诞生记[转]</a></h1></header><div class="post__main echo"><p><img src="https://pic2.zhimg.com/v2-52726a7f86690c0663452112d66836c5_1200x500.jpg" alt="JavaScript 世界万物诞生记"></p>
<p>原文作者:<a href="//www.zhihu.com/people/suyun">苏云</a></p>
<p>原文地址:<a href="https://zhuanlan.zhihu.com/p/22989691" target="_blank" rel="noopener">JavaScript 世界万物诞生记</a></p>
<h2 id="一-无中生有"><a href="#一-无中生有" class="headerlink" title="一. 无中生有"></a>一. 无中生有</h2><p>起初，什么都没有。<br>造物主说：没有东西本身也是一种东西啊，于是就有了null：</p>
<p><img src="https://pic1.zhimg.com/v2-11ae989e2db3a380ffe225e382652671_b.jpg" alt>现在我们要造点儿东西出来。但是没有原料怎么办？<br>有一个声音说：不是有null嘛？<br>另一个声音说：可是null代表无啊。<br>造物主说：那就无中生有吧！<br>于是：</p>
<p><img src="https://pic3.zhimg.com/v2-4305232695aafb0ffb3df63caec39dd1_b.jpg" alt>JavaScript中的1号对象产生了，不妨把它叫做No. 1。<br>这个No. 1对象可不得了，它是真正的万物始祖。它拥有的性质，是所有的对象都有的。<br><strong>proto</strong>是什么呢？是“生”的意思，或者叫做<strong>继承</strong>。</p>
<h2 id="二-制造对象的机器"><a href="#二-制造对象的机器" class="headerlink" title="二. 制造对象的机器"></a>二. 制造对象的机器</h2><p>既然已经有了一个对象，剩下就好办了，因为一生二，二生三，三生万物嘛。<br>不过造物主很懒，他不想一个一个地亲手制造对象。于是他做了一台能够制造对象的机器：</p>
<p><img src="https://pic1.zhimg.com/v2-2458a871bafadca8b0551e2252d69fec_b.jpg" alt>他给这台机器起了一个名字：<strong>Object</strong>。<br>这台机器并不能凭空造出对象，它需要一个模板对象，按照这个模板对象来制造对象。很自然的，它把目前仅有的No. 1对象作为模板。图中的prototype就代表机器的<strong>模板对象</strong>。</p>
<p>机器如何启动呢？通过<strong>new</strong>命令。你对着机器喊一声：“new！”，对象就造出来了。  </p>
<p>机器的产生，实现了对象的批量化自动化生产，解放了造物主的双手。于是造物主忙别的去了。<br>如果机器只是按照模板的样子，机械地复制出一模一样的对象，那就太笨了。<br>人类的后代在继承了父辈的性状的基础上，可以产生父辈没有的性状。同样地，机器在制造对象时，除了继承模板对象的属性外，还可以添加新的属性。这使得JavaScript世界越来越多样化。</p>
<p>比如说，有一天Object机器制造一个对象，它有一个特殊的属性，叫做flag，属性值是10。用图形表示是这样的：</p>
<p><img src="https://pic2.zhimg.com/v2-6d345dec589e84311315a3decaa21d8b_b.jpg" alt></p>
<p>写成代码就是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var obj = new Object(&#123; flag: 10 &#125;);</span><br></pre></td></tr></table></figure>
<p>轰轰烈烈的造物运动开始了……  </p>
<h2 id="三-更多制造对象的机器"><a href="#三-更多制造对象的机器" class="headerlink" title="三. 更多制造对象的机器"></a>三. 更多制造对象的机器</h2><p>一天天过去了，造物主来视察工作。看到Object制造出了好多好多对象，他非常高兴。<br>同时他还发现：根据“物以类聚”的原则，这些对象可以分成很多<strong>类</strong>。聪明的造物主想，我何不多造几台机器，让每一台机器专门负责制造某一类对象呢？于是，他动手造出了几台机器并给它们起了名字。它们分别是：</p>
<p><strong>String</strong>：用来制造表示一段文本的对象。<br><strong>Number</strong>：用来制造表示一个数字的对象。<br><strong>Boolean</strong>：用来制造表示是与非的对象。<br><strong>Array</strong>：用来制造有序队列对象。<br><strong>Date</strong>：用来制造表示一个日期的对象。<br><strong>Error</strong>：用来制造表示一个错误的对象。<br>……</p>
<p>多台机器齐开动，各司其责，造物运动进入了一个新的阶段……  </p>
<p>造物主又开始思考了：虽然机器是用来制造对象的，但是机器本身实际上也是一种特殊对象啊。现在有了这么多机器，我得好好总结一下它们的共同特征，把它们也纳入对象体系。  </p>
<p>于是，造物主基于No. 1对象，造出了一个No. 2对象，用它来表示所有机器的共同特征。换句话说，把它作为所有机器的原型对象。</p>
<p><img src="https://pic3.zhimg.com/v2-b6cbde61439e841e4c6353d3546fc482_b.jpg" alt></p>
<p>（注：<strong>proto</strong>写起来太麻烦了，后面我们用[p]来代替）</p>
<p>当然了，和Object一样，这些机器也需要各自有一个模板对象，也就是它们的prototype属性指向的那个对象。显然它们的模板对象应该是继承自No. 1对象的，即  </p>
<p><img src="https://pic4.zhimg.com/v2-34ab309d1e2e415071afd1c19f216275_b.jpg" alt></p>
<p>这张图显示了JavaScript世界中那些最基本的机器本身的原型链，以及它们的模板对象的原型链。不过看起来太复杂了，所以后面我们就不再把它们完整地画出来了。</p>
<h2 id="四-制造机器的机器"><a href="#四-制造机器的机器" class="headerlink" title="四. 制造机器的机器"></a>四. 制造机器的机器</h2><p>造物主高兴地想：这下可好了，我造出了Object机器，实现了对象制造的自动化。然后又造出了String、Number等机器，实现了特定类别的对象制造的自动化。但是，为啥总感觉似乎还缺点什么呢？</p>
<p>对啦，还缺少一台<strong>制造机器的机器</strong>啊！</p>
<p>很快，万能的造物主就把它造了出来，并把它命名为<strong>Function</strong>。有了Function机器后，就可以实现自动化地制造机器了。</p>
<p>让我们来观察一下Function：<br>首先，Function是一台机器，所以它的原型对象也是No. 2对象。<br>其次，Function又是一台制造机器的机器，所以它的模板对象也是No. 2对象。<br>所以我们得到了Function的一个非常特别的性质：</p>
<pre><code>Function.__proto__ === Function.prototype
</code></pre><p>哇，太奇妙了！  </p>
<p>不要奇怪，这个性质不过是”Function是一台制造机器的机器“这个事实的必然结果。</p>
<p>于是JavaScript的世界的变成了下面的样子：</p>
<p><img src="https://pic2.zhimg.com/v2-1b90d4ec60713acce99df0c498fff794_b.jpg" alt>从这张图中，我们发现：所有的函数(包括Function)的原型都是No. 2对象，而同时Function.prototype也是No. 2对象。这说明了：</p>
<blockquote>
<p>从逻辑上，我们可以认为所有机器(包括Function自己)都是由Function制造出来的。</p>
</blockquote>
<p>同时，如果再仔细瞧瞧，你会发现：</p>
<blockquote>
<p>Object作为一个机器可以看做是有由Function制造出来的，而Function作为一个对象可以看做是由Object制造出来的。</p>
</blockquote>
<p>这就是JavaScript世界的“鸡生蛋，蛋生鸡”问题。那么到底是谁生了谁呢？Whatever！</p>
<h2 id="五-让世界动起来"><a href="#五-让世界动起来" class="headerlink" title="五. 让世界动起来"></a>五. 让世界动起来</h2><p>就像前面所说，机器用来制造某一类对象。正因如此，机器可以作为这类对象的标志，即面向对象语言中类(class)的概念。所以机器又被称为<strong>构造函数</strong>。在ES6引入class关键字之前，我们常常把构造函数叫做类。</p>
<p>然而，除了作为构造函数来制造对象外，函数通常还有另一个功能：<strong>做一件事情</strong>。正是有了这个功能，JavaScript的世界才由静变动，变得生机勃勃。</p>
<p>比如说，我们现在用Function机器制造了鸟类(即用来造鸟的机器)：</p>
<pre><code>function Bird(color) {
    this.color = color;
}
</code></pre><p>然后，对着造鸟机说：“new！”，于是造鸟机发动起来，制造一个红色的鸟：</p>
<pre><code>var redBird = new Bird(&apos;#FF0000&apos;);
</code></pre><p>如果现在我们想让鸟飞起来，该怎么办呢？我们需要再次用Function制造出一台机器，不过这台机器不是用来制造对象的，而是用来做事儿的，即“让鸟飞起来”这件事情：</p>
<pre><code>// 这是一台通过晃动鸟的翅膀，让鸟飞起来的简陋的机器。
function makeBirdFly(bird) {
    shakeBirdWing(bird);
}
</code></pre><p>我们知道，让一台制造对象的机器发动，只需要对它喊“new”即可；那么怎样让一台做事情的机器发动呢？更简单，对它咳嗽一声就行了。咳咳咳，</p>
<pre><code>makeBirdFly(redBird);
</code></pre><p>于是红鸟飞了起来，世界充满了生机。</p>
<p>从上面的Bird和makeBirdFly的定义可以看出：实际上，制造对象的机器和做事情的机器没什么明显区别，不同的只是它们的使用方式。在两种情况下，它们分别被叫做<strong>构造函数</strong>和<strong>普通函数</strong>。</p>
<p>说明1：function xxx语法可以看成new Function的等价形式。<br>说明2：用户自定义的函数通常既可以作为普通函数使用，又可以作为构造函数来制造对象。ES6新增的class语法定义的函数只能作为构造函数，ES6新增的=&gt;语法定义的箭头函数只能作为普通函数。  </p>
<h2 id="六-让世界立体起来"><a href="#六-让世界立体起来" class="headerlink" title="六. 让世界立体起来"></a>六. 让世界立体起来</h2><p>造物主对目前的世界还是不太满意，因为几乎所有的机器的模板对象都是No. 2，这使得JavaScript世界看起来有点扁。</p>
<p>于是造物主再次研究世界万物的分类问题。他发现有些对象会动、还会吃东西，于是把它们叫做动物，然后造了一台Animal机器来制造它们。他进一步发现，即使都是动物，也还是可以进一步分类，比如有些会飞、有些会游，他分别把它们叫做鸟类、鱼类。于是他想，我何不单独造几台机器，专门用来制造某一类动物呢。于是它造出了Bird、Fish等机器。</p>
<p>接下来，在选择这些机器的模板对象时碰到一个问题：如果还像之前那样直接复制一个No. 1对象作为Bird、Fish的模板，那么结果就是这样的：</p>
<p><img src="https://pic4.zhimg.com/v2-f3ef45a4e9402b4dda44132cde989b34_b.jpg" alt>这样可不好。首先没体现出鸟类、鱼类跟动物的关系，其次它们的模板对象存了重复的东西，这可是一种浪费啊。怎么办呢？简单，让Bird和Fish的模板对象继承自Animal的模板对象就好了。就是说</p>
<pre><code>Bird.prototype.__proto__ === Animal.prototype
Fish.prototype.__proto__ === Animal.prototype
</code></pre><p>于是：</p>
<p><img src="https://pic4.zhimg.com/v2-2d659369503dba1cb92e682a540e0e70_b.jpg" alt>用同样的方法，造物主造出了一个立体得多的JavaScript世界。</p>
<p>然而这样还不够。虽然那些纯对象现在充满了层次感，但是那些机器对象之间的关系还是扁平的：</p>
<p><img src="https://pic1.zhimg.com/v2-6644774193179923f2d403378bc67317_b.jpg" alt></p>
<p>那又该怎么办呢？其实用类似的办法就行了：  </p>
<p><img src="https://pic3.zhimg.com/v2-d99bca010604438e4101c58534aea24b_b.jpg" alt>为了更方便地做到这一点，造物主发明了class关键字。</p>
<h2 id="七-世界最终的样子"><a href="#七-世界最终的样子" class="headerlink" title="七. 世界最终的样子"></a>七. 世界最终的样子</h2><p>经过一番折腾，JavaScript世界发生了大变化。变得丰富多彩，同时变得很复杂。用一张图再也没法画出它的全貌，只能画出冰山一角：</p>
<p><img src="https://pic2.zhimg.com/v2-2860797f5b29eb118bb4e55e802a09b4_b.jpg" alt></p>
<p>JavaScript的世界还在不断进化中……</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/转载/" class="post__tag__link">转载</a></li></ul><a href="/2018/10/24/JavaScript-世界万物诞生记[转]/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2019 Junian<bdi> |  <a target="_blank" href="http://www.beian.miit.gov.cn/">粤ICP备19044128号</a></bdi></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/2018/11/21/全剧终/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/2018/10/19/树莓派成果报表/" class="page-menu__link icon-arrow-right"></a></li></menu></footer></body></html>